Make_SAM フォルダについての説明
==============================

このフォルダには、CGE分析用の日本のSAMの作成をおこなうためのプログラムが含まれています。




## ファイルの説明

| ファイル                                               | 説明                                         |
|:-------------------------------------------------------|:---------------------------------------------|
| [create_IO.vba](create_IO.vba)                         | 「IO表の作成」というマクロを定義するファイル |
| [create_SAM.vba](create_SAM.vba)                       | 「SAMの作成」というマクロを定義するファイル  |
| [SAM_for_CGE_template.xlsm](SAM_for_CGE_template.xlsm) | 上の2つのマクロが組込まれた Excel ファイル   |


## 利用方法

ここでは、`Make_IO` フォルダのプログラムで作成されたデータを利用します。例として、
`japan_2011_26x18.set` という set ファイルを用いて作成された
`japan_2011_26x18.xlsx` というデータを利用します。


### Step 1

`IO_data` というフォルダで作業をするので、`Make_IO` フォルダで作成した
`japan_2011_26x18.xlsx` ファイルを `IO_data` フォルダにコピーしておきます。

`SAM_for_CGE_template.xlsm` を適当な名前で、`IO_data` フォルダにコピーします。こ
こでは `japan_2011_26x18.xlsm` という名前でコピーします。拡張子が `xlsm` となっ
ている Excel ファイルはマクロが組込まれたファイルです。

`japan_2011_26x18.xlsx` の中の全てのシートを `japan_2011_26x18.xlsm` ファイルに
コピーします。

### Step 2

`japan_2011_26x18.xlsm` ファイルには元々「設定」というシートが含まれています。こ
の「設定」シートで SAM を作成するときの設定を変更できるのですが、とりあえず変更
なしでそのままにしておきます。


### Step 3

`japan_2011_26x18.xlsm` ファイルに組込まれている「IO表の作成」というマクロを実行します。これには、

+ 「開発」タブ → 「マクロ」 → 「IO表の作成」を選択 → 「実行」ボタンをクリック

とします。

これで、「IO」というシートが作成され、SAM を作成する元になる IO 表などが作成されます。


### Step 4

次に「SAMの作成」というマクロを実行します（実行手順は上とほぼ同じです）。すると、
「SAM」というシートが作成され、そこに SAM が出力されます。

ここで作成される SAM は [「応用一般均衡分析入
門」](https://shirotakeda.org/ja/research-ja/cge-howto.html) の第7章で作成されて
いるものと同じようなものです。SAM の意味については「応用一般均衡分析入門」を見て
ください。

「応用一般均衡分析入門」の第7章で実際に利用されている部門分類のデータを作成した
いのなら、Make_IO の方で 2015 年の産業連関表から `japan_2015_15x12.set`、
`japan_2015_50x40.set` を使ってデータを作成してください。





# 注

ここにある SAM 作成用の VBA マクロを利用するには、統合したデータにおける付加価値
部門、最終需要部門が以下のような分類になっていなければいけない。

```
set     va      付加価値部門 /
epin    "雇用者所得"
ssce    "社会保障雇主負担"
opse    "営業余剰"
depr    "資本減耗引当"
idtx    "間接税"
subs    "補助金"
/;

set     fd      最終需要部門 /
hhco    "民間消費"
gvci    "政府消費（個別）"
gvcc    "政府消費（集合）"
invp    "投資（民間）"
invg    "投資（公的）"
inve    "在庫投資"
expo    "輸出"
impo    "輸入"
imta    "関税"
imtx    "輸入品商品税"
```









<!--
--------------------
Local Variables:
mode: markdown
fill-column: 80
coding: utf-8-dos
End:
-->

