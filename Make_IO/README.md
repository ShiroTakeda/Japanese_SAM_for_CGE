<!--
Filename:       README.md
Author:         Shiro Takeda
e-mail          <shiro.takeda@gmail.com>
First-written:  <2020-11-29>
Time-stamp:     <2021-12-24 16:06:36 st>
-->

Make_IO フォルダについて説明
==============================

## 概要

このフォルダのプログラムでは以下のことをおこないます。

+ 元の産業連関表のデータ、3EIDデータを GAMS で利用しやすい用に加工
+ 元の財・部門の統合

### ［注］

+ 以下の作業では DOS のバッチファイル（拡張子が bat のファイル）を使います。
+ バッチファイルでは gams のプログラムを呼出しているので、gams のプログラム
  （gams.exeというファイル）にパス（PATH）が通っている必要があります。
+ 直接 gms ファイルを実行すれば、バッチファイルを使わなくても同じようなことはで
  きるのですが、以下ではとりあえず DOS のバッチファイルを使う前提で話をしていま
  す。
  
## 手順

以下の手順でプログラムを実行します（バッチファイルをクリックすれば実行できます）。

+ ステップ1: まず、source_data フォルダに行き、そこで `run_covert_io_table.bat` を実行します。
+ ステップ2: 元の Make_IO フォルダで `run_make_io.bat` を実行
+ ステップ3: Make_IO フォルダで `run_make_3EID.bat` を実行

この後、データの統合をします。それには

+ ステップ4: `run_aggr.bat` を実行

そして、統合されたデータのチェックをします。

+ ステップ5: `run_check_aggr_data.bat` を実行

以下、各ステップをもう少し詳しく説明します。


### ステップ1

これで Excel ファイルに入っている産業連関表データを GAMS が扱いやすい GDX ファイ
ルに変換します。バッチファイルの中で souce_data フォルダの
`convert_io_table.gms` を実行しています。2015年、2011年、2005年の 3 つのデータを
変換しています。

この結果、source_data フォルダに `original_io_XXXX.gdx` というような名前（XXXXの
ところは年）の GDX ファイルが作成されます。


### ステップ2

ここでステップ1で作成したIO表のファイルからデータを読み込み、CGE分析で利用しやす
い用に加工をします。

+ 注: 加工といってもデータの数値を変えているわけではなく、形式の変更をしているだ
  けです。
  
中で source_data フォルダの `make_io.gms` を実行しています。

    call gams make_io.gms --year=2015
    
というような形式で実行します。
  
    --year=XXXX
      
 の部分で何年のデータかを指定します。2005、2011、2015の3年分のデータがあり、3年
 分全て実行します。
 
 この結果、`japan_io_2015.gdx`、`japan_io_2011.gdx`、`japan_io_2005.gdx` という3
つのファイルが data フォルダに作成されます。

  
### ステップ3

ここで3EIDデータを Excel ファイルから読み込み、産業連関表のデータに合うように加
工します。

この中で、

    call gams make_3eid_2015
    call gams make_3eid_2011
    call gams make_3eid_2005
    
のように3つのプログラムを実行しています。それぞれ 2015年、2011年、2005年のデータ
用です。

この結果、`japan_io_2015_co2.gdx`、`japan_io_2011_co2.gdx`、
`japan_io_2005_co2.gdx` という3つのファイルが data フォルダに作成されます。


### ステップ4

ここまでのデータでは元の産業連関表の部門分類のままになっています。ここではその部
門分類を統合します。

統合するためには以下の二つのファイルが必要になります。

+ 統合後の部門分類を定義したファイル
+ 元の分類と統合後の分類の対応を指定するファイル

前者は拡張子を「set」とするので以下では set ファイルと呼びます。同様に、後者のファ
イルは拡張子を「map」とするので以下では map ファイルと呼びます。

set ファイル、map ファイルはともに set フォルダに置いてください。

#### set ファイルの設定

set ファイルでは以下の4つの set を指定します。

+ row: これは統合後の行部門（財）の set。
+ col: これは統合後の列部門（部門）の set。

このうち「row」、「col」を自分の望む部門統合に従い指定してください。

row と col に加え以下の二つの set も定義されています。

+ va: これは統合後の付加価値部門の set。
+ fd: これは統合後の最終需要部門の set。

この二つは自分では変更しないでください。

#### map ファイルの設定

map ファイルのん名前は拡張子以外は set ファイルと同じにします。例えば、set ファ
イルが `japan_2015_15x12.set` なら map ファイルは`japan_2015_15x12.map` とします。

map ファイルでは

+ row_map: これは行部門（財）の対応を指定する set
+ col_map: これは列部門（部門）の対応を指定する set

の二つを指定します。

#### CO2データの利用

CO2データを利用したい場合には aggr.gms の中の

    * $setglobal fl_use_co2 1
    
となっている部分を

    $setglobal fl_use_co2 1

のようにコメントアウト記号をとってください。



## ファイル

| ファイル            | 説明                               |
|:--------------------|:-----------------------------------|
| `jecon.bst`         | これが bst ファイルです。          |
| `jecon-example.tex` | 使い方等の説明をしたファイルです。 |
| `README.md`         | このファイルです。                 |


<!--
--------------------
Local Variables:
mode: markdown
fill-column: 80
coding: utf-8-dos
End:
-->

